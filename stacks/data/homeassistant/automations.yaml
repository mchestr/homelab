- id: watering_alert_tts
  alias: Plants Need Water Alert TTS
  trigger:
    platform: numeric_state
    entity_id:
    - sensor.aloe_soil_moisture
    - sensor.clyde_soil_moisture
    - sensor.magda_soil_moisture
    - sensor.parker_soil_moisture
    below: 40
    for: "01:00:00"
  condition:
    condition: or
    conditions:
    - condition: time
      after: "08:00:00"
      before: "22:00:00"
      weekday:
      - sat
      - sun
    - condition: time
      after: "07:00:00"
      before: "09:00:00"
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
    - condition: time
      after: "17:00:00"
      before: "22:00:00"
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
  action:
  - service: tts.google_translate_say
    entity_id: media_player.family_room_speaker
    data_template:
      message: "Hey Fam, {{ trigger.to_state.attributes.friendly_name }} needs some water!"

- id: watering_alert_notify
  alias: Plants Need Water Alert Notify
  trigger:
    platform: numeric_state
    entity_id:
    - sensor.aloe_soil_moisture
    - sensor.clyde_soil_moisture
    - sensor.magda_soil_moisture
    - sensor.parker_soil_moisture
    below: 40
    for: "01:00:00"
  action:
  - service: notify.notify
    data_template:
      title: "{{ trigger.to_state.attributes.friendly_name }} Needs water!"
      message: "Currently: {{ trigger.to_state.state }}%"

- id: zoomba_bin_full
  alias: Zoomba bin is full
  trigger:
    platform: template
    value_template: "{%if is_state_attr('vacuum.zoomba', 'bin_full', true) %}true{%endif%}"
  action:
  - service: notify.notify
    data_template:
      title: "Zoomba bin is full!"
      message: "Bin is full!"

- id: cat_lights_away_on
  alias: Turn on lights for cats when away from home
  trigger:
    platform: sun
    event: sunset
    offset: "-00:30:00"
  condition:
  - condition: state
    entity_id: group.all_persons
    state: away
  action:
  - service: light.turn_on
    data:
      entity_id: light.cat_lamp
      brightness_pct: 40

- id: cat_lights_away_off
  alias: Turn off lights for cats when away from home
  trigger:
    platform: sun
    event: sunrise
    offset: '+00:00:00'
  condition:
  - condition: state
    entity_id: group.all_persons
    state: away
  action:
  - service: light.turn_off
    data:
      entity_id: light.cat_lamp

- id: wakeup_routine
  alias: Fade hue go on slowly
  trigger:
    platform: time
    at: "06:30:00"
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: person.mike
      state: home
    - condition: time
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
  action:
  - service: light.turn_on
    data:
      entity_id: light.hue_go_1
      transition: 300
      brightness: 77
      hs_color:
      - 38.667
      - 52.941
      rgb_color:
      - 255
      - 207
      - 120
      xy_color:
      - 0.457
      - 0.41
  - service: light.turn_on
    data:
      entity_id: light.living_room
      brightness: 255
  - delay: 00:10:00
  - service: light.turn_on
    data:
      entity_id: light.living_room
      brightness: 255

- id: lights_off_away
  alias: Turn lights off when away
  trigger:
    platform: state
    entity_id: group.all_persons
    from: home
    to: away
    for: "00:10:00"
  action:
  - service: light.turn_off
    data:
      entity_id: light.all

- id: lights_on_coming_home
  alias: Turn entry lights when coming home
  trigger:
  - platform: state
    entity_id: group.all_persons
    to: home
  action:
  - service: light.turn_on
    data:
      entity_id: light.entryway
      brightnes: 255
